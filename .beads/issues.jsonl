{"id":"id-00k","title":"Test: Worker route integration (full HTTP flows)","status":"closed","priority":0,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:08.692543-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:58:24.086958-06:00","closed_at":"2026-02-16T07:58:24.086958-06:00","close_reason":"worker-routes.test.ts: 122 tests passing"}
{"id":"id-0cq","title":"Fix 48 failing existing tests","status":"closed","priority":1,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:02.195049-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:56:32.879717-06:00","closed_at":"2026-02-16T07:56:32.879717-06:00","close_reason":"All 740 tests passing, 0 failures"}
{"id":"id-0d8","title":"Route GitHub webhook endpoint for claim-by-commit flow","description":"GitHubApp class has full implementation (webhook signature verification, JWT generation, claim token extraction) but NO route receives webhooks. Need: POST /webhooks/github route in worker, verify signature, call GitHubApp.handlePush(), handle claim result. Without this, the Connect→Operate→Claim flow is broken.","status":"closed","priority":0,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:00:59.916479-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T16:49:42.518524-06:00","closed_at":"2026-02-07T16:49:42.518524-06:00","close_reason":"Already implemented - POST /webhook/github route exists with HMAC verification and claim handling"}
{"id":"id-0jb","title":"Implement scoped API keys","description":"API keys currently grant full identity permissions with no scoping. When a key is created via /api/keys, it is associated with an identity but cannot be restricted to specific entities, operations, or tenants. Need: scope claim on API key records, tenant-scoped keys, operation-scoped keys, checked by requireAuth() middleware.","status":"open","priority":2,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:55.357502-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:55.357502-06:00"}
{"id":"id-1nv","title":"Implement CLI (login, logout, whoami, token, status)","status":"closed","priority":1,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:11.323102-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T08:04:26.312623-06:00","closed_at":"2026-02-16T08:04:26.312623-06:00","close_reason":"CLI implemented: login, logout, whoami, token, status — 49 tests"}
{"id":"id-1zn","title":"Fix broken .do domain CORS origin regex","description":"In src/csrf/index.ts line 55, the regex /^https?:\\/\\/([a-z0-9-]+\\.)*\\.do$/ requires a literal dot before 'do', so it matches https://.do (invalid) but NOT https://oauth.do or https://events.do. No .do domain passes the CORS origin check, causing silent auth failures for cross-origin requests from .do domains. Fix: change to /^https?:\\/\\/([a-z0-9-]+\\.)*[a-z0-9-]+\\.do$/ or enumerate specific .do domains.","status":"closed","priority":0,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:54.012677-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:40:46.617367-06:00","closed_at":"2026-02-23T05:40:46.617367-06:00","close_reason":"Fixed in e1fb573 — isSafeRedirectUrl + .do CORS regex"}
{"id":"id-2wg","title":"Test: IdentityDO (provision, claim, sessions, API keys, rate limits)","status":"closed","priority":0,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:07.322006-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:56:33.489905-06:00","closed_at":"2026-02-16T07:56:33.489905-06:00","close_reason":"identity-do.test.ts: 149 tests passing"}
{"id":"id-42w","title":"Implement automated RSA key rotation","description":"No automated key rotation mechanism exists. SigningKeyManager supports multiple keys (for rotation) but there is no cron job or scheduled handler to rotate keys. Key rotation is manual. Need: (1) scheduled handler (Cloudflare Cron Trigger) to rotate keys on cadence (e.g. every 90 days), (2) during rotation both old and new keys in JWKS for overlap period, (3) CI/CD step to rebuild and deploy the CDN auth snippet after rotation.","status":"open","priority":2,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:55.211347-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:55.211347-06:00"}
{"id":"id-4ll","title":"Build GitHub App webhook handler for claim-by-commit","status":"closed","priority":1,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:58:55.832475-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T12:27:35.907527-06:00","closed_at":"2026-02-07T12:27:35.907527-06:00","close_reason":"All implemented: GitHub App webhook, GitHub Action, MCP explore/try/search/fetch/do tools, Ed25519 keypairs with DID format","dependencies":[{"issue_id":"id-4ll","depends_on_id":"id-4us","type":"blocks","created_at":"2026-02-07T11:59:09.1186-06:00","created_by":"Nathan Clevenger"}]}
{"id":"id-4us","title":"Implement OAuth 2.1 provider with PKCE and Device Flow","status":"closed","priority":1,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:58:52.453899-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T12:16:56.751064-06:00","closed_at":"2026-02-07T12:16:56.751064-06:00","close_reason":"Full OAuth 2.1 provider implemented: PKCE, Device Flow, refresh token rotation, DCR, introspection, revocation (1354 lines)"}
{"id":"id-59q","title":"Deprecate org.ai package — thin re-export of id.org.ai","status":"closed","priority":3,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:59:03.003472-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T11:59:53.750941-06:00","closed_at":"2026-02-07T11:59:53.750941-06:00","close_reason":"org.ai is NOT being deprecated — it re-exports id.org.ai plus ~30 other .org.ai primitives","dependencies":[{"issue_id":"id-59q","depends_on_id":"id-4us","type":"blocks","created_at":"2026-02-07T11:59:09.462265-06:00","created_by":"Nathan Clevenger"}]}
{"id":"id-5bw","title":"Replace catch(err: any) with catch(err: unknown)","description":"Multiple catch blocks use 'any' type (worker/index.ts lines 808, 1154) and access err.message without guards. If err is not an Error (e.g. a string throw), accessing .message returns undefined. Fix: use catch(err: unknown) with err instanceof Error ? err.message : String(err).","status":"open","priority":2,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:55.502455-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:55.502455-06:00"}
{"id":"id-636","title":"Cache SigningKeyManager at module level","description":"In worker/index.ts, own JWT verification creates a new SigningKeyManager per request and calls oauthStub.oauthStorageOp() to load keys from the DO. The manager has an in-memory cache (loaded flag) but a new instance is created each time across requests. Every JWT verification hits IdentityDO storage at least once per request. Fix: cache the SigningKeyManager or its JWKS data at module level, similar to auth-verifier's jwksCache pattern.","status":"open","priority":2,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:55.070187-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:55.070187-06:00"}
{"id":"id-6or","title":"Replace flat entity storage with queryable format for MCP tools","description":"MCP do handler stores entities as flat key-value: entity:{id}:{type}:{id}. Cannot implement search() or fetch() MCP tools — no filtering by type/stage/fields. Need: migrate to D1 or structured DO storage that supports queries. Currently search tool returns stubs, fetch tool cannot filter.","status":"closed","priority":1,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:01:13.630818-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-08T06:49:50.771816-06:00","closed_at":"2026-02-08T06:49:50.771816-06:00","close_reason":"Implemented: queryable DO storage with secondary indexes"}
{"id":"id-7xr","title":"Implement MCP auth with progressive capability tiers (L0-L3)","status":"closed","priority":1,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:58:58.405376-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T12:16:56.946594-06:00","closed_at":"2026-02-07T12:16:56.946594-06:00","close_reason":"MCPAuth implemented with L0-L3 progressive capability tiers as part of id-p5u","dependencies":[{"issue_id":"id-7xr","depends_on_id":"id-p5u","type":"blocks","created_at":"2026-02-07T11:59:09.254037-06:00","created_by":"Nathan Clevenger"}]}
{"id":"id-8e3","title":"Test: Cookie auth (set, read, expiry, clear)","status":"closed","priority":0,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:10.174355-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:58:23.966617-06:00","closed_at":"2026-02-16T07:58:23.966617-06:00","close_reason":"cookie-auth.test.ts: 93 tests passing"}
{"id":"id-9jb","title":"Fix open redirect in login/logout flows","description":"Login continue URL and logout return_url are used in HTTP Location headers without validation. An attacker can craft https://auth.headless.ly/login?continue=https://evil.com to redirect users to malicious sites after authentication. The logout endpoint has no CSRF protection and takes redirect URL directly from query string. Fix: validate redirect URLs against isAllowedOrigin() or only allow relative paths (starting with /). Files: worker/index.ts lines 752, 856, 874.","status":"closed","priority":0,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:53.867704-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:40:46.615411-06:00","closed_at":"2026-02-23T05:40:46.615411-06:00","close_reason":"Fixed in e1fb573 — isSafeRedirectUrl + .do CORS regex"}
{"id":"id-ajm","title":"Test: OAuth 2.1 provider (all grant types, PKCE, device flow)","status":"closed","priority":0,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:05.470405-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:56:33.248565-06:00","closed_at":"2026-02-16T07:56:33.248565-06:00","close_reason":"oauth-provider.test.ts: 110 tests passing"}
{"id":"id-bm3","title":"Add CSRF protection and audit logging","description":"No CSRF tokens on provision/claim endpoints, CORS is origin:* (overly permissive), no origin validation. Also zero audit logging — no logging of identity creation, claim events, key registration, rate limit breaches, or failed auth attempts. Need: CSRF tokens on OAuth flows, origin validation, audit log for all sensitive operations.","status":"closed","priority":2,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:01:22.130643-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-08T07:28:13.79179-06:00","closed_at":"2026-02-08T07:28:13.79179-06:00","close_reason":"Implemented: standard error format, CSRF + audit logging"}
{"id":"id-c4x","title":"Remove unused D1 database config or wire Drizzle ORM","description":"D1 database 'id-org-ai' is declared in wrangler.jsonc but NEVER used. Drizzle ORM schema is defined in src/db/schema.ts but never instantiated. All data lives in DO storage. Either: (A) migrate session/entity data to D1 for queryable storage, or (B) remove D1 config and Drizzle schema to eliminate dead code.","status":"closed","priority":1,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:01:09.1005-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-08T05:43:47.111912-06:00","closed_at":"2026-02-08T05:43:47.111912-06:00","close_reason":"Implemented in hardening wave"}
{"id":"id-cib","title":"Add Ed25519 agent keypair support and DID format","status":"closed","priority":2,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:58:59.884006-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T12:27:35.980618-06:00","closed_at":"2026-02-07T12:27:35.980618-06:00","close_reason":"All implemented: GitHub App webhook, GitHub Action, MCP explore/try/search/fetch/do tools, Ed25519 keypairs with DID format","dependencies":[{"issue_id":"id-cib","depends_on_id":"id-7xr","type":"blocks","created_at":"2026-02-07T11:59:09.322934-06:00","created_by":"Nathan Clevenger"}]}
{"id":"id-cnk","title":"Fix CSRF timingSafeEqual length leak","description":"In src/csrf/index.ts lines 303-310, timingSafeEqual returns false immediately when lengths differ, leaking whether lengths match. Since CSRF tokens are always 64 hex chars the practical risk is low. Fix: use crypto.subtle.timingSafeEqual on Workers or hash both values first.","status":"open","priority":3,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:55.654648-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:55.654648-06:00"}
{"id":"id-coc","title":"Move id.org.ai DNS to Cloudflare","description":"id.org.ai DNS currently points to Vercel (marketing site), not the Cloudflare auth worker. This means: (1) OIDC discovery at https://id.org.ai/.well-known/openid-configuration returns nothing useful, (2) standard OIDC clients expecting id.org.ai as issuer fail discovery, (3) JWT iss claim cannot be validated by libraries that auto-discover JWKS. Worker is reachable via auth.headless.ly as workaround. Moving DNS to Cloudflare is a correctness issue for OIDC compliance.","status":"open","priority":1,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:54.185603-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:54.185603-06:00"}
{"id":"id-cpo","title":"Wire OAuth 2.1 provider into worker routing","description":"800-line OAuth 2.1 provider exists in src/oauth/provider.ts but is NOT wired into the worker. getOAuthProvider(c) is called but never defined — runtime crash on OIDC Discovery. Need: define getOAuthProvider(), route /oauth/authorize, /oauth/token, /oauth/device, /oauth/register endpoints, implement token response with JWT signing.","status":"closed","priority":0,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:00:51.665225-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T16:49:42.378947-06:00","closed_at":"2026-02-07T16:49:42.378947-06:00","close_reason":"Already implemented - OAuth 2.1 provider fully wired with all routes in worker/index.ts"}
{"id":"id-ev8","title":"Build GitHub Action (dot-org-ai/id@v1) for claim confirmation","status":"closed","priority":1,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:58:57.573549-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T12:27:35.929896-06:00","closed_at":"2026-02-07T12:27:35.929896-06:00","close_reason":"All implemented: GitHub App webhook, GitHub Action, MCP explore/try/search/fetch/do tools, Ed25519 keypairs with DID format","dependencies":[{"issue_id":"id-ev8","depends_on_id":"id-4ll","type":"blocks","created_at":"2026-02-07T11:59:09.187-06:00","created_by":"Nathan Clevenger"}]}
{"id":"id-ixk","title":"Shard IdentityDO by tenant instead of global singleton","description":"All requests funnel through idFromName('global') — single DO instance. Cloudflare DOs have CPU/request-rate limits. Unscalable past ~1000 concurrent agents, multi-tenancy broken. Fix: use idFromName(tenantId ?? identityId) to shard by tenant. Every identity/tenant gets its own DO.","status":"closed","priority":0,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:00:47.063268-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-08T05:43:47.059021-06:00","closed_at":"2026-02-08T05:43:47.059021-06:00","close_reason":"Implemented in hardening wave"}
{"id":"id-l71","title":"Standardize error response format across all endpoints","description":"Three different error formats: {error:'unauthorized'}, {error:'unauthorized',message:'...'}, {error_description:'...'}. Client code cannot standardize error handling. Pick one format (OAuth error_description or plain error), define error code constants, validate all endpoints return consistent shape.","status":"closed","priority":2,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:01:18.073693-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-08T07:28:13.756768-06:00","closed_at":"2026-02-08T07:28:13.756768-06:00","close_reason":"Implemented: standard error format, CSRF + audit logging"}
{"id":"id-n58","title":"Align isAdmin role check with auth-verifier","description":"id.org.ai AuthService.isAdmin() checks ['admin', 'superadmin'] (worker/index.ts line 434), while auth-verifier checks only ['admin']. A superadmin user is recognized as admin by id.org.ai but NOT by auth-verifier. Both should check the same role set. Fix in both repos.","status":"open","priority":1,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:54.448235-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:54.448235-06:00"}
{"id":"id-n7i","title":"Implement explore and try MCP tools","status":"closed","priority":2,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:59:01.481635-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T12:27:35.954546-06:00","closed_at":"2026-02-07T12:27:35.954546-06:00","close_reason":"All implemented: GitHub App webhook, GitHub Action, MCP explore/try/search/fetch/do tools, Ed25519 keypairs with DID format","dependencies":[{"issue_id":"id-n7i","depends_on_id":"id-p5u","type":"blocks","created_at":"2026-02-07T11:59:09.390653-06:00","created_by":"Nathan Clevenger"}]}
{"id":"id-nyd","title":"Test: AuthService RPC (verifyToken, authenticate, roles, permissions)","status":"closed","priority":0,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:03.235788-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:56:33.004493-06:00","closed_at":"2026-02-16T07:56:33.004493-06:00","close_reason":"auth-service.test.ts: 111 tests passing"}
{"id":"id-nze","title":"Test: JWT signing, JWKS endpoint, key rotation","status":"closed","priority":0,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:04.28763-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:56:33.124787-06:00","closed_at":"2026-02-16T07:56:33.124787-06:00","close_reason":"jwt-signing.test.ts: 81 tests passing"}
{"id":"id-p5u","title":"Implement anonymous tenant provisioning (Level 0 → 1)","status":"closed","priority":1,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T11:58:54.315493-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-07T12:16:56.850343-06:00","closed_at":"2026-02-07T12:16:56.850343-06:00","close_reason":"Anonymous provisioning, MCPAuth, ClaimService, IdentityDO endpoints all implemented"}
{"id":"id-pyo","title":"Test: WorkOS login flow, code exchange, sk_* API key validation","status":"closed","priority":0,"issue_type":"task","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-16T07:48:06.381893-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-16T07:56:33.370271-06:00","closed_at":"2026-02-16T07:56:33.370271-06:00","close_reason":"workos.test.ts: 51 tests passing"}
{"id":"id-sn5","title":"Fix test suite execution (vitest not found)","description":"4 test files exist (~97 tests per git log) covering MCP auth, MCP tools, crypto keys, and claim service. But pnpm test fails with 'vitest: command not found' because dependencies aren't installed. Fix: ensure pnpm install works in workspace context, add to CI, fix any test failures.","status":"closed","priority":1,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-07T16:01:04.924452-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-08T05:43:47.08522-06:00","closed_at":"2026-02-08T05:43:47.08522-06:00","close_reason":"Implemented in hardening wave"}
{"id":"id-son","title":"Implement id_token issuance for OIDC compliance","description":"Server metadata advertises id_token_signing_alg_values_supported but no actual id_token generation exists in the token endpoint. Token endpoint returns access_token and refresh_token but not id_token. Infrastructure exists (JWKS, SigningKeyManager, nonce support) — just needs actual id_token generation in the code grant exchange. This is the single biggest OIDC compliance gap.","status":"open","priority":2,"issue_type":"feature","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:54.92727-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:54.92727-06:00"}
{"id":"id-vnd","title":"Add org field to AuthUser type (parity with auth-verifier)","description":"id.org.ai's AuthUser type (worker/index.ts line 126-135) is missing the deprecated 'org' field that auth-verifier populates. Consumers checking user.org get undefined when token was verified by id.org.ai but it works via auth-verifier. Either add org to id.org.ai AuthUser or migrate all consumers to use organizationId. Part of broader AuthUser consolidation effort.","status":"open","priority":1,"issue_type":"bug","owner":"4130910+nathanclevenger@users.noreply.github.com","created_at":"2026-02-23T05:20:54.767583-06:00","created_by":"Nathan Clevenger","updated_at":"2026-02-23T05:20:54.767583-06:00"}
